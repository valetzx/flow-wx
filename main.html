<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>我的作品集</title>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Masonry 布局 */
      .masonry {
        column-count: 3;
        column-gap: 1rem;
      }
      @media (max-width: 1024px) {
        .masonry {
          column-count: 2;
        }
      }
      @media (max-width: 640px) {
        .masonry {
          column-count: 1;
        }
      }
      .masonry-item {
        break-inside: avoid;
        margin-bottom: 1rem;
      }
      .sidebar-link {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0.5rem;
        border-radius: 0.375rem;
        color: #6b7280;
        transition: background-color 0.2s, color 0.2s;
      }
      .sidebar-link:hover {
        background-color: #f1f5f9;
        color: #111827;
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-slate-50 to-slate-200 min-h-screen font-sans">
    <nav class="fixed top-0 left-0 h-screen w-[72px] bg-white border-r shadow flex flex-col items-center space-y-6 py-4">
      <a href="/" aria-label="主页" class="sidebar-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
          <path d="M12 2a10 10 0 1 0 4.25 19.17l.7-2.82A3.8 3.8 0 0 1 13.9 19c-1.17 0-2.08-.67-2.08-1.87 0-.42.05-.62.15-.92l.52-1.72c.23-.71.23-1.28.23-1.28 0-1.18-.65-1.8-1.53-1.8-1.28 0-2.09 1.2-2.09 2.88 0 .74.12 1.45.35 2.07l-1.2 5.18A12 12 0 1 1 12 2z"/>
        </svg>
      </a>
      <a href="/" aria-label="首页" class="sidebar-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
          <path d="M12 3.1 1 9l1 2 1-1v10h6v-5h4v5h6V10l1 1 1-2-11-5.9Z" />
        </svg>
      </a>
      <a href="/ideas" aria-label="探索" class="sidebar-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
          <path d="M12 21a9 9 0 1 0-9-9 9 9 0 0 0 9 9m0-8a1 1 0 1 1 1-1 1 1 0 0 1-1 1m-.66-8.76a3 3 0 0 0-2.18 2.18L7.64 14a2.25 2.25 0 0 0 2.73 2.73l6.15-1.54a3 3 0 0 0 2.18-2.18l1.54-6.15a2.25 2.25 0 0 0-2.73-2.73Z" />
        </svg>
      </a>
      <a href="/pin-creation-tool/" aria-label="创建" class="sidebar-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
          <path d="M11 11H6v2h5v5h2v-5h5v-2h-5V6h-2zM5 1a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h14a4 4 0 0 0 4-4V5a4 4 0 0 0-4-4Z"/>
        </svg>
      </a>
      <a href="#" aria-label="消息" class="sidebar-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
          <path d="M7 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3m5 3a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m5 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m-5 10c1.8 0 3.5-.41 5-1.15l3.69.65A2 2 0 0 0 23 20.7l-.65-3.7A11.5 11.5 0 1 0 12 23.5Z" />
        </svg>
      </a>
      <a href="#" aria-label="更多" class="sidebar-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
          <path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10m3 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
          <path d="M6.35 1.37a2 2 0 0 0-1.93.54 12 12 0 0 0-2.7 4.67c-.22.72.01 1.46.5 1.95L2.59 12l-1.57 1.56a2 2 0 0 0-.5 1.95 12 12 0 0 0 2.7 4.68c.51.54 1.27.72 1.93.54l2.14-.58.58 2.14c.17.67.7 1.24 1.43 1.4a12 12 0 0 0 5.4 0 2 2 0 0 0 1.43-1.4l.58-2.14 2.13.58c.67.18 1.43 0 1.94-.55a12 12 0 0 0 2.7-4.67 2 2 0 0 0-.5-1.94L21.4 12l1.57-1.56c.49-.5.71-1.23.5-1.95a12 12 0 0 0-2.7-4.67 2 2 0 0 0-1.93-.54l-2.14.57-.58-2.13a2 2 0 0 0-1.43-1.4 12 12 0 0 0-5.4 0Z"/>
        </svg>
      </a>
    </nav>
    <div class="ml-[72px]">
    <header class="py-6 text-center">
      <h1 class="text-3xl font-bold tracking-tight text-slate-800">
        我的作品集
      </h1>
    </header>

    <main class="px-4 max-w-screen-xl mx-auto">
      <!-- Masonry 容器 -->
      <div class="masonry" id="gallery"></div>
    </main>

    <script>
      // 动态加载数据并渲染
      async function loadGallery() {
        try {
          const res = await fetch('/api/wx');
          if (!res.ok) throw new Error('Network response was not ok');
          const data = await res.json();
          const gallery = document.getElementById('gallery');
          const fragments = [];

          for (const [title, { description, images }] of Object.entries(data)) {
            // 标题卡片
            fragments.push(
              `<div class=\"masonry-item p-5 bg-white rounded-2xl shadow hover:shadow-lg transition flex flex-col gap-2\">\n  <h2 class=\"text-xl font-semibold text-slate-900\">${title}</h2>\n  <p class=\"text-sm text-gray-600 leading-relaxed\">${description}</p>\n</div>`
            );
            // 图片
            images.forEach((src) => {
              fragments.push(
                `<img class=\"masonry-item w-full rounded-2xl shadow object-cover hover:opacity-90 transition\" src=\"/img?url=${src}\" alt=\"${title}\" loading=\"lazy\"/>`
              );
            });
          }

          gallery.innerHTML = fragments.join('');
        } catch (err) {
          console.error('加载画廊失败:', err);
        }
      }

      document.addEventListener('DOMContentLoaded', loadGallery);
    </script>
</div>
  </body>
</html>
